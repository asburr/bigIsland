[
    {"files": {
        "root": "directory.files",
        "path": {
            "path": "test/Hallelulajah/data",
            "depth": 1,
            "readonly": "test/Hallelulajah/data_processed",
            "feeds": [
                {"feed": "{root}.schema", "regex": "title\\.txt"},
                {"feed": "{root}.attributes", "regex": "company_attributes\\.csv"},
                {"feed": "{root}.company", "regex": "company\\.csv"},
                {"feed": "{root}.country", "regex": "country\\.csv"},
                {"feed": "{root}.pbx", "regex": "pbx\\.csv"},
                {"feed": "{root}.new", "regex": ".*\\.csv"}
            ]
        }
    }},
    {"loadf": {
        "files": "directory.files.attributes",
        "feed": "directory.attributes",
        "schema": {"file": {"feed": "directory.files.schema", "filetype": {"oracleTable": "ATTRIBUTES"} } },
        "fstats": "directory.attributes.stats"
    }},
    {"loadf": {
        "files": "directory.files.company",
        "feed": "directory.company",
        "schema": {"file": {"feed": "directory.files.schema", "filetype": {"oracleTable": "COMPANY"} } },
        "fstats": "directory.company.stats"
    }},
    {"loadf": {
        "files": "directory.files.country",
        "feed": "directory.country",
        "schema": {"file": {"feed": "directory.files.schema", "filetype": {"oracleTable": "COUNTRY"} } },
        "fstats": "directory.country.stats"
    }},
    {"loadf": {
        "files": "directory.files.pbx",
        "feed": "directory.pbx",
        "fstats": "stats.pbx",
        "schema": {"file": { "feed": "directory.files.schema", "filetype": {"oracleTable": "PBX"} } } 
    }},
    {"expand": {
        "feed": "directory.pbx.telephone",
        "input": "directory.pbx",
        "join": {
            "fields": [{"field": "directory.pbx.COUNTRY_ID"}],
            "with": "directory.country",
            "on": [{"field": "directory.country.COUNTRY_ID"}]
        },
        "add": {
            "add": "directory.pbx.TELEPHONE",
            "fmt": "{}{}{}{}",
            "fields": [
                {"field": "directory.country.CC"},
                {"field": "directory.pbx.AREACODE"},
                {"field": "directory.pbx.LOCALCODE"},
                {"field": "directory.pbx.SUBSCRIBER"}
            ]
        }
    }},
    {"alert": {
        "input": "directory.files.new",
        "sumtype": "SUM",
        "email": "{EMAIL}",
        "period": 60
    }},
    {"alert": {
        "feed": "directory.alerts",
        "sumtype": "SUM",
        "email": "{EMAIL}",
        "period": 60
    }}
]